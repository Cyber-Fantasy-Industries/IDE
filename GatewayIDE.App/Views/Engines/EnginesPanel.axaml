<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="GatewayIDE.App.Views.Engines.EnginesPanel">

  <UserControl.Styles>

    <Style Selector="Border.card">
      <Setter Property="Background" Value="#141414"/>
      <Setter Property="BorderBrush" Value="#2a2a2a"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="12"/>
      <Setter Property="Padding" Value="14"/>
    </Style>

    <Style Selector="TextBlock.h1">
      <Setter Property="Foreground" Value="#eaeaea"/>
      <Setter Property="FontSize" Value="18"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
    </Style>

    <Style Selector="TextBlock.h2">
      <Setter Property="Foreground" Value="#eaeaea"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
    </Style>

    <Style Selector="TextBlock.muted">
      <Setter Property="Foreground" Value="#9a9a9a"/>
      <Setter Property="FontSize" Value="12"/>
    </Style>

    <Style Selector="TextBox.field">
      <Setter Property="Background" Value="#101010"/>
      <Setter Property="BorderBrush" Value="#2a2a2a"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="10"/>
      <Setter Property="Padding" Value="10,7"/>
      <Setter Property="Foreground" Value="#eaeaea"/>
    </Style>

    <Style Selector="TextBox.field /template/ TextBlock#PART_Watermark">
      <Setter Property="Foreground" Value="#7a7a7a"/>
    </Style>

    <Style Selector="Button.action">
      <Setter Property="Background" Value="#222"/>
      <Setter Property="Foreground" Value="#eaeaea"/>
      <Setter Property="BorderBrush" Value="#333"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="10"/>
      <Setter Property="Padding" Value="12,7"/>
      <Setter Property="Cursor" Value="Hand"/>
    </Style>

    <Style Selector="Button.action:pointerover">
      <Setter Property="Background" Value="#2b2b2b"/>
    </Style>

    <Style Selector="Border.row">
      <Setter Property="Background" Value="#101010"/>
      <Setter Property="BorderBrush" Value="#242424"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="10"/>
      <Setter Property="Padding" Value="10"/>
    </Style>

    <Style Selector="TextBlock.mono">
      <Setter Property="FontFamily" Value="Consolas, Cascadia Mono, Menlo, monospace"/>
      <Setter Property="FontSize" Value="12"/>
      <Setter Property="Foreground" Value="#d8d8d8"/>
    </Style>

    <Style Selector="TabItem">
      <Setter Property="Foreground" Value="#cfcfcf"/>
      <Setter Property="Background" Value="#111"/>
      <Setter Property="BorderBrush" Value="#2a2a2a"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="10,10,0,0"/>
      <Setter Property="Padding" Value="12,8"/>
      <Setter Property="Margin" Value="0,0,8,0"/>
    </Style>

    <Style Selector="TabItem:selected">
      <Setter Property="Foreground" Value="#ffffff"/>
      <Setter Property="Background" Value="#1a1a1a"/>
    </Style>

  </UserControl.Styles>

  <Grid Background="#0f0f0f" Margin="12" RowDefinitions="Auto,12,*">

    <!-- Header -->
    <Border Grid.Row="0" Classes="card">
      <Grid RowDefinitions="Auto,6,Auto">
        <TextBlock Classes="h1" Text="Engines"/>
        <TextBlock Grid.Row="2" Classes="muted"
                   Text="Engines anzeigen, installieren und konfigurieren (später: Auto-Discover)."/>
      </Grid>
    </Border>

    <!-- Body -->
    <Border Grid.Row="2" Classes="card">
      <TabControl SelectedIndex="{Binding SelectedTabIndex}">

        <!-- Installed -->
        <TabItem Header="Installed">
          <Grid ColumnDefinitions="340,12,*">

            <!-- Left list -->
            <Grid RowDefinitions="Auto,10,Auto,10,*">
              <TextBlock Classes="h2" Text="Installed Engines"/>
              <TextBox Grid.Row="2" Classes="field" Watermark="Search installed…"
                       Text="{Binding InstalledSearch}"/>

              <ListBox Grid.Row="4"
                       ItemsSource="{Binding InstalledEngines}"
                       SelectedItem="{Binding SelectedEngine}">
                <ListBox.ItemTemplate>
                  <DataTemplate>
                    <Border Classes="row" Margin="0,0,0,8">
                      <StackPanel Spacing="2">
                        <TextBlock Classes="mono" Text="{Binding Name}"/>
                        <TextBlock Classes="muted"
                                   Text="{Binding Version, StringFormat=Version: \{0\}}"/>
                        <TextBlock Classes="muted"
                                   Text="{Binding Status, StringFormat=Status: \{0\}}"/>
                      </StackPanel>
                    </Border>
                  </DataTemplate>
                </ListBox.ItemTemplate>
              </ListBox>
            </Grid>

            <!-- Right details -->
            <Border Grid.Column="2" Background="#101010" BorderBrush="#222" BorderThickness="1" CornerRadius="10" Padding="12">
              <Grid RowDefinitions="Auto,10,Auto,10,Auto,10,*">
                <Grid ColumnDefinitions="*,Auto">
                  <TextBlock Classes="h2" Text="Details"/>
                  <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <Button Classes="action" Content="Configure" Command="{Binding ConfigureSelectedCommand}"/>
                    <Button Classes="action" Content="Remove" Command="{Binding RemoveSelectedCommand}"/>
                  </StackPanel>
                </Grid>

                <TextBlock Grid.Row="2" Classes="mono"
                           Text="{Binding SelectedEngine.Name, FallbackValue=(no engine selected)}"/>

                <TextBlock Grid.Row="4" Classes="muted"
                          Text="{Binding SelectedEngine.Description, FallbackValue=(no description)}"/>


                <Border Grid.Row="6" BorderBrush="#222" BorderThickness="1" CornerRadius="10" Padding="10" Background="#0f0f0f">
                  <StackPanel Spacing="6">
                    <TextBlock Classes="h2" Text="Settings (Preview)"/>
                    <TextBlock Classes="muted"
                               Text="Später: Engine-spezifische Settings / Env / Paths / Provider Keys."/>
                  </StackPanel>
                </Border>
              </Grid>
            </Border>

          </Grid>
        </TabItem>

        <!-- Available -->
        <TabItem Header="Available">
          <Grid RowDefinitions="Auto,10,Auto,10,*">

            <TextBlock Classes="h2" Text="Available Engines"/>
            <TextBox Grid.Row="2" Classes="field" Watermark="Search catalog…"
                     Text="{Binding CatalogSearch}"/>

            <StackPanel Grid.Row="4" Spacing="8">
              <Border Classes="row">
                <Grid ColumnDefinitions="*,Auto">
                  <StackPanel Spacing="2">
                    <TextBlock Classes="mono" Text="ExampleEngine.A"/>
                    <TextBlock Classes="muted" Text="Placeholder catalog entry"/>
                  </StackPanel>
                  <Button Grid.Column="1" Classes="action" Content="Install"
                          Command="{Binding InstallCatalogItemCommand}"/>
                </Grid>
              </Border>

              <Border Classes="row">
                <Grid ColumnDefinitions="*,Auto">
                  <StackPanel Spacing="2">
                    <TextBlock Classes="mono" Text="ExampleEngine.B"/>
                    <TextBlock Classes="muted" Text="Placeholder catalog entry"/>
                  </StackPanel>
                  <Button Grid.Column="1" Classes="action" Content="Install"
                          Command="{Binding InstallCatalogItemCommand}"/>
                </Grid>
              </Border>
            </StackPanel>

          </Grid>
        </TabItem>

        <!-- Settings -->
        <TabItem Header="Global">
          <StackPanel Spacing="12">
            <TextBlock Classes="h2" Text="Global Engine Settings"/>
            <Grid ColumnDefinitions="200,12,*" RowDefinitions="Auto,10,Auto,10,Auto">
              <TextBlock Text="Default Engine" Classes="muted"/>
              <TextBox Grid.Column="2" Classes="field" Watermark="e.g. dotnet, python, node"
                       Text="{Binding Global.DefaultEngine}"/>

              <TextBlock Grid.Row="2" Text="Engines Root Path" Classes="muted"/>
              <TextBox Grid.Row="2" Grid.Column="2" Classes="field" Watermark="C:\GatewayIDE\engines"
                       Text="{Binding Global.EnginesRootPath}"/>

              <TextBlock Grid.Row="4" Text="Auto Update" Classes="muted"/>
              <CheckBox Grid.Row="4" Grid.Column="2"
                        IsChecked="{Binding Global.AutoUpdate}"
                        Content="Auto update installed engines"
                        Foreground="#eaeaea"/>
            </Grid>
          </StackPanel>
        </TabItem>

      </TabControl>
    </Border>

  </Grid>
</UserControl>
